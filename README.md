
## ç›®å½•ç»“æ„

CAMEL_AGENT/
â”‚
â”œâ”€â”€ main.py                    # é¡¹ç›®å…¥å£ï¼Œå¯åŠ¨APIæœåŠ¡æˆ–å‘½ä»¤è¡Œ
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ default_config.yaml     # é»˜è®¤å‚æ•°é…ç½®ï¼ˆæ¨¡å¼é€‰æ‹©ã€è¶…å‚æ•°ã€è§’è‰²è®¾å®šç­‰ï¼‰
â”‚   â””â”€â”€ prompt_templates/       # Promptæ¨¡æ¿æ–‡ä»¶
â”‚
â”œâ”€â”€ api/                        # å¯¹å¤–APIæ¥å£
â”‚   â”œâ”€â”€ routes.py               # è·¯ç”±å®šä¹‰ï¼ˆFlaskAPIï¼‰
â”‚   â”œâ”€â”€ handlers.py             # APIä¸šåŠ¡å¤„ç†å±‚
â”‚   â””â”€â”€ schemas.py              # è¯·æ±‚/å“åº”å‚æ•°æ¨¡å‹
â”‚
â”œâ”€â”€ data_processing/            # æ•°æ®å¤„ç†è„šæœ¬
â”‚   â”œâ”€â”€ clean_book_zh.py           # æ•°æ®æ¸…æ´—
â”‚   â”œâ”€â”€ load_log.py           # é¢„å¤„ç†ï¼ˆåˆ†è¯ã€å»å™ªï¼‰
â”‚   â””â”€â”€ csv_sql.py      # äººå·¥æ ‡æ³¨è¾…åŠ©
â”‚   â”œâ”€â”€ clean_log.py           # æ•°æ®æ¸…æ´—

â”œâ”€â”€ embedding/                  # å‘é‡åŒ–ä¸å‘é‡å­˜å‚¨
â”‚   â”œâ”€â”€ pre_embedding.py    # åå°æ‰‹åŠ¨å®ç°å‘é‡åŒ–åˆ°çŸ¥è¯†åº“
â”‚   â””â”€â”€ auto_embedding.py         # æ”¯æŒè‡ªåŠ¨å‘é‡åŒ–åˆ°çŸ¥è¯†åº“ä¸­
â”‚   â””â”€â”€ japan_book_chunking.py         # æ‰‹åŠ¨chunkingå…»æ®–æ‰‹å†Œ
â”‚
â”œâ”€â”€ orchestrator/               # ä»»åŠ¡è°ƒåº¦å™¨
â”‚   â””â”€â”€ task_orchestrator.py    # æ ¹æ®é…ç½®åŠ è½½å¹¶æ‰§è¡Œæ’ä»¶
â”‚
â”œâ”€â”€ agents/                     # æ™ºèƒ½ä½“æ’ä»¶
â”‚   â”œâ”€â”€ base_agent.py           # åŸºç±»
â”‚   â”œâ”€â”€ single_dialog_agent.py  # å•è½®å¯¹è¯
â”‚   â”œâ”€â”€ multi_scenario_agent.py # å¤šåœºæ™¯åˆ†æï¼ˆå¤šè§’è‰²ï¼‰
â”‚   â””â”€â”€ juudge_agent.py
â”‚   â””â”€â”€ summarize_agent.py
â”‚   â””â”€â”€ plan_agent.py
â”‚   â””â”€â”€ text2sql_agent.py
â”‚
â”œâ”€â”€ rag_pipeline/                 # kbçš„ç®¡ç†+ragåŠŸèƒ½
â”‚   â””â”€â”€ autorag.py       # langchainæ¥è¿›è¡Œkbç®¡ç†+RAGæ£€ç´¢+ä¸Šä¸‹æ–‡æ‹¼æ¥
â”‚   â””â”€â”€ handlerag.py       # camel  kbç®¡ç†+RAGæ£€ç´¢+ä¸Šä¸‹æ–‡æ‹¼æ¥
â”‚
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ logger.py               # æ—¥å¿—
â”‚   â”œâ”€â”€ loader.py               # é…ç½®å’ŒPromptåŠ è½½
â”‚
â”œâ”€â”€ interface/                      # å‰ç«¯æ˜¾ç¤ºé¡µé¢
â”‚   â”œâ”€â”€ gradio.py               # æ—¥å¿—   
â”‚
â”œâ”€â”€ tests/                      # æµ‹è¯•
â”‚   â”œâ”€â”€ test_api.py
â”‚   â”œâ”€â”€ test_embedding.py
â”‚   â”œâ”€â”€ test_agents.py
â”‚   â””â”€â”€ test_orchestrator.py
â”œâ”€â”€ run_qa/                      # æµ‹è¯•
â”‚   â”œâ”€â”€ bank_qa.py    
â”‚   â”œâ”€â”€ default_qa.py
â”‚   â”œâ”€â”€ japan_qa.py
â”‚   â””â”€â”€ orchestrator.py
â”‚
â”œâ”€â”€ download/            # ä¸‹è½½
â””â”€â”€ models/                   # embeddingæ¨¡å‹
â”œâ”€â”€ requirements.txt            # ä¾èµ–
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜æ–‡ä»¶


# ğŸ¦ ShrimpRAG Assistant
> **ä¸€æ¬¾åŸºäº CAMEL å¤šæ™ºèƒ½ä½“ + RAG çš„å—ç¾ç™½å¯¹è™¾å…»æ®–æ™ºèƒ½é—®ç­”ä¸åˆ†æç³»ç»Ÿ**

---

## ğŸ“š ç›®å½•ï¼ˆTable of Contentsï¼‰
- [é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#-åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#-ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹)
- [ç¯å¢ƒé…ç½®](#-ç¯å¢ƒé…ç½®)
- [æ ¸å¿ƒæ¨¡å—è¯´æ˜](#-æ ¸å¿ƒæ¨¡å—è¯´æ˜)
- [API æ–‡æ¡£](#-api-æ–‡æ¡£)
- [ç®—æ³•ä¸æ¨¡å‹](#-ç®—æ³•ä¸æ¨¡å‹)
- [æµ‹è¯•ä¸éªŒè¯](#-æµ‹è¯•ä¸éªŒè¯)
- [éƒ¨ç½²æŒ‡å—](#-éƒ¨ç½²æŒ‡å—)
- [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)
- [ç‰ˆæœ¬è®°å½•](#-ç‰ˆæœ¬è®°å½•)
- [è®¸å¯è¯](#-è®¸å¯è¯)
- [è‡´è°¢](#-è‡´è°¢)

---

## ğŸ“ é¡¹ç›®ç®€ä»‹
**ShrimpRAG Assistant** æ˜¯ä¸€æ¬¾æ™ºèƒ½åŒ–çŸ¥è¯†é—®ç­”ä¸åˆ†æç³»ç»Ÿï¼Œæ—¨åœ¨ä¸ºå—ç¾ç™½å¯¹è™¾å…»æ®–æˆ·åŠç§‘ç ”äººå‘˜æä¾›ï¼š
- ğŸ“– **å¿«é€Ÿæ£€ç´¢**ï¼šç§’çº§æœç´¢å…»æ®–æ‰‹å†Œä¸­çš„è®¾è®¡è§„èŒƒ  
- ğŸ¤– **æ™ºèƒ½æ¨ç†**ï¼šåŸºäº CAMEL å¤šæ™ºèƒ½ä½“è¿›è¡Œä¸“å®¶çº§å›ç­”  
- ğŸ“Š **æ•°æ®åˆ†æ**ï¼šå¯¹ç¤¾äº¤åª’ä½“èšç±»æ–‡æœ¬è¿›è¡Œæ¶ˆè´¹è€…å¿ƒç†ä¸å› æœåˆ†æ  
- ğŸ“‘ **è‡ªåŠ¨æŠ¥å‘Š**ï¼šç”Ÿæˆ PDF/Word æ ¼å¼çš„å†³ç­–æ”¯æŒæŠ¥å‘Š  

> æœ¬é¡¹ç›®é¢å‘ **å†œä¸š AI åŠ©æ‰‹ã€çŸ¥è¯†æ£€ç´¢ã€æ•°æ®åˆ†æ** ç­‰åœºæ™¯ï¼Œæ”¯æŒæœ¬åœ°åŒ–éƒ¨ç½²ã€‚

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§
- ğŸ” **æ··åˆæ£€ç´¢**ï¼šBM25 + FAISS + Rerank æä¾›ç²¾å‡†ä¸Šä¸‹æ–‡  
- ğŸ§  **å¤šæ™ºèƒ½ä½“åä½œ**ï¼šåŸºäº CAMEL çš„ Expert AI ä¸ Helper AI  
- ğŸŒ **è”ç½‘æœç´¢**ï¼šé›†æˆ Tavily APIï¼Œæ”¯æŒå®æ—¶ç½‘ç»œæœç´¢å’Œæ–°é—»æ£€ç´¢
- ğŸ“ˆ **ç»Ÿè®¡å»ºæ¨¡**ï¼šæ”¯æŒè¯é¢‘ç»Ÿè®¡ã€è¯äº‘å¯è§†åŒ–ã€å› æœæ¨å¯¼  
- ğŸ“‚ **æ–‡æ¡£å¯¼å…¥**ï¼šæ”¯æŒ PDF/Docx è§£æä¸ç»“æ„åŒ– Chunk åˆ’åˆ†  
- ğŸ“¡ **å¼€æ”¾ API**ï¼šRESTful æ¥å£ä¾¿äºé›†æˆå…¶ä»–ç³»ç»Ÿ  
- âš¡ **è½»é‡éƒ¨ç½²**ï¼šæ”¯æŒ Conda & Docker ä¸€é”®éƒ¨ç½²  
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä¸­è‹±æ–‡é—®é¢˜è§£æä¸å›ç­”  

---

## ğŸ— ç³»ç»Ÿæ¶æ„
![ç³»ç»Ÿæ¶æ„å›¾](docs/architecture.png)

**æ¶æ„è¯´æ˜ï¼š**
1. **å‰ç«¯ UI**ï¼šåŸºäº Gradio æä¾›äº¤äº’ç•Œé¢  
2. **API æœåŠ¡**ï¼šä½¿ç”¨ FastAPI æä¾› REST æ¥å£  
3. **æ£€ç´¢å±‚**ï¼šBM25 + FAISS æ··åˆæ£€ç´¢ä¸ Rerank  
4. **å¤šæ™ºèƒ½ä½“**ï¼šCAMEL RolePlayingï¼ˆExpert AI & Helper AIï¼‰  
5. **æ¨¡å‹å±‚**ï¼šQwen-72B ç”¨äºæ¨ç†ä¸æŠ¥å‘Šç”Ÿæˆ  
6. **æ•°æ®å­˜å‚¨**ï¼šSQLite + å‘é‡æ•°æ®åº“  

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone https://github.com/your-org/shrimp-rag-assistant.git
cd shrimp-rag-assistant
````

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–

```bash
conda create -n shrimp_agent python=3.10
conda activate shrimp_agent
pip install -r requirements.txt
```

### 2.1 é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶å¹¶æ·»åŠ å¿…è¦çš„ API Keysï¼š

```env
# Tavily API (è”ç½‘æœç´¢åŠŸèƒ½)
TAVILY_API_KEY=your_tavily_api_key_here

# OpenAI API
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. å¯åŠ¨æœåŠ¡

```bash
python app.py
```

> è®¿é—® `http://localhost:7860` æŸ¥çœ‹ Web UIã€‚

---

## ğŸ’» ç¯å¢ƒé…ç½®

* **Python**: >= 3.10
* **CUDA**: >= 11.8 (æ¨è GPU æ¨ç†)
* **å†…å­˜**: >= 16GB
* **ä¸»è¦ä¾èµ–**ï¼š

```txt
fastapi==0.115.0
gradio==4.41.0
faiss-cpu==1.8.0
camel-ai==0.2.3
qwen==1.7.0
```

---

## ğŸ” æ ¸å¿ƒæ¨¡å—è¯´æ˜

| æ¨¡å—å                | æè¿°                        | è¾“å…¥        | è¾“å‡º          |
| ------------------ | ------------------------- | --------- | ----------- |
| `file_parser.py`   | è§£æ PDF/Docxï¼Œè¿›è¡Œç« èŠ‚ Chunk åˆ’åˆ† | PDF è·¯å¾„    | JSONï¼ˆç»“æ„åŒ–æ•°æ®ï¼‰ |
| `rag_retriever.py` | ä½¿ç”¨ BM25+FAISS æ£€ç´¢ç›¸å…³çŸ¥è¯†å—     | ç”¨æˆ·é—®é¢˜      | Top-k æ–‡æœ¬å—   |
| `agents/`          | CAMEL å¤šæ™ºèƒ½ä½“åä½œå›ç­”            | é—®é¢˜ + æ£€ç´¢ç»“æœ | å›ç­”æ–‡æœ¬        |
| `web_search_tools.py` | è”ç½‘æœç´¢ä¸æ–°é—»æ£€ç´¢ (Tavily API)  | æœç´¢æŸ¥è¯¢    | æœç´¢ç»“æœåˆ—è¡¨   |
| `report_gen.py`    | åˆ†æèšç±»æ–‡æœ¬å¹¶ç”Ÿæˆå¿ƒç†å­¦å› æœåˆ†ææŠ¥å‘Š        | èšç±»æ–‡æœ¬æ•°æ®    | Word/PDF æŠ¥å‘Š |
| `api.py`           | æä¾› RESTful API            | JSON è¯·æ±‚   | JSON å“åº”     |

---

## ğŸ“¡ API æ–‡æ¡£

### `POST /api/ask`

* **æè¿°**ï¼šæ™ºèƒ½é—®ç­”æ¥å£
* **Request ç¤ºä¾‹**

```json
{
  "question": "å¾ªç¯æ°´ç³»ç»Ÿæº¶æ°§æ ‡å‡†æ˜¯å¤šå°‘ï¼Ÿ"
}
```

* **Response ç¤ºä¾‹**

```json
{
  "answer": "å»ºè®®ä¿æŒ 5.5 mg/L ä»¥ä¸Šï¼Œä»¥ç¡®ä¿è™¾ç±»å¥åº·ç”Ÿé•¿ã€‚"
}
```

### `POST /api/report`

* **æè¿°**ï¼šç”Ÿæˆæ¶ˆè´¹è€…å¿ƒç†åˆ†ææŠ¥å‘Š
* **Request ç¤ºä¾‹**

```json
{
  "cluster_file": "clusters.csv"
}
```

* **Response ç¤ºä¾‹**

```json
{
  "report_path": "output/report_2025-09-28.docx"
}
```

### `POST /api/web_search`

* **æè¿°**ï¼šè”ç½‘æœç´¢è·å–å®æ—¶ä¿¡æ¯
* **Request ç¤ºä¾‹**

```json
{
  "query": "å—ç¾ç™½å¯¹è™¾å…»æ®–æœ€æ–°æŠ€æœ¯",
  "max_results": 3,
  "search_depth": "basic"
}
```

* **Response ç¤ºä¾‹**

```json
{
  "answer": "å—ç¾ç™½å¯¹è™¾å…»æ®–æœ€æ–°æŠ€æœ¯åŒ…æ‹¬...",
  "results": [
    {
      "title": "...",
      "url": "...",
      "content": "...",
      "score": 0.95
    }
  ],
  "total_results": 3
}
```

---

## ğŸ§  ç®—æ³•ä¸æ¨¡å‹

* **åµŒå…¥æ¨¡å‹**ï¼šBERT-baseï¼Œç”¨äºå¥å‘é‡è®¡ç®—
* **èšç±»ç®—æ³•**ï¼šKMeansï¼ˆk=15ï¼‰
* **å¤§è¯­è¨€æ¨¡å‹**ï¼šQwen-72B-Chatï¼Œç”¨äºæ€»ç»“ä¸æ¨ç†
* **è¯„ä¼°æŒ‡æ ‡**ï¼š

  * Diarization Error Rate (DER)ï¼š7.5%
  * Word Error Rate (WER)ï¼š12.4%

---

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

```bash
pytest tests/
```

ç¤ºä¾‹è¾“å‡ºï¼š

```
tests/test_rag.py .......   [100%]
tests/test_agent.py ...    [ 90%]
```

---

## ğŸŒ éƒ¨ç½²æŒ‡å—

### æœ¬åœ°éƒ¨ç½²

```bash
python app.py
```

### Docker éƒ¨ç½²

```bash
docker build -t shrimp_agent .
docker run -p 7860:7860 shrimp_agent
```

---

## â“ å¸¸è§é—®é¢˜

**Q:** å¯åŠ¨æ—¶æŠ¥ `CUDA not found`
**A:** å®‰è£… GPU é©±åŠ¨å¹¶å¯¼å‡ºç¯å¢ƒå˜é‡ï¼š

```bash
export PATH=/usr/local/cuda/bin:$PATH
```

**Q:** å¯åŠ¨åæ— æ³•è®¿é—® `http://localhost:7860`
**A:** æ£€æŸ¥é˜²ç«å¢™ä¸ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚

---

## ğŸ“œ ç‰ˆæœ¬è®°å½•

| ç‰ˆæœ¬å·    | æ—¥æœŸ         | æ›´æ–°å†…å®¹                       |
| ------ | ---------- | -------------------------- |
| v1.3.0 | 2025-10-13 | é›†æˆ Tavily è”ç½‘æœç´¢åŠŸèƒ½ï¼Œåˆ é™¤ç¤ºä¾‹å·¥å…·ä»£ç  |
| v1.2.0 | 2025-09-28 | æ–°å¢æ¶ˆè´¹è€…å¿ƒç†åˆ†æä¸æŠ¥å‘Šç”ŸæˆåŠŸèƒ½           |
| v1.1.0 | 2025-09-20 | å¼•å…¥ BM25+FAISS æ··åˆæ£€ç´¢ä¸ Rerank |
| v1.0.0 | 2025-09-10 | å®ŒæˆåŸºç¡€ RAG é—®ç­”ä¸ PDF è§£æåŠŸèƒ½      |

---

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE)ã€‚

---

## ğŸ™ è‡´è°¢

ç‰¹åˆ«æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’Œå›¢é˜Ÿï¼š

* [CAMEL-AI](https://github.com/camel-ai/camel)
* [Qwen](https://qwen.ai)
* [FAISS](https://github.com/facebookresearch/faiss)
* [Gradio](https://gradio.app)

```

---

âœ¨ **ä½¿ç”¨æ–¹æ³•**  
1. æ–°å»º `README.md` æ–‡ä»¶ï¼ŒæŠŠä»¥ä¸Šå†…å®¹å®Œæ•´å¤åˆ¶è¿›å»ã€‚  
2. ä¿®æ”¹æ ‡é¢˜ã€ä¾èµ–ç‰ˆæœ¬ã€API ç¤ºä¾‹ã€æ¶æ„å›¾é“¾æ¥ç­‰ä¸ºä½ é¡¹ç›®çš„å®é™…æƒ…å†µã€‚  
3. åœ¨ `docs/` ç›®å½•ä¸‹ä¿å­˜æ¶æ„å›¾æ–‡ä»¶ï¼Œä¾‹å¦‚ `architecture.png` å¹¶ä¿æŒè·¯å¾„ä¸€è‡´ã€‚  

éœ€è¦æˆ‘å¸®ä½ æŠŠè¿™ä»½ README æ‰“åŒ…æˆä¸€ä¸ªå¯ä¸‹è½½çš„ Markdown æ–‡ä»¶å—ï¼Ÿ
```
